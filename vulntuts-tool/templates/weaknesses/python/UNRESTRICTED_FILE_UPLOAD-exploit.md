If a server software offers the functionality to upload files, this may provide attackers the ability to also upload malicious files to the server if it does not validate the files.

A common variant is that the software saves the file to a folder within the web document root (e.g., a folder named `uploads`:

<pre class="language-python line-numbers"><code>
import cgi, os
import cgitb
cgitb.enable()

form = cgi.FieldStorage()
fileitem = form['filename']

# check if the file has been uploaded
if fileitem.filename:
    # strip the leading path from the file name
    filename = os.path.basename(fileitem.filename)

    # write the file to the server
    open("uploads/" + filename, 'wb').write(fileitem.file.read())
</code></pre>

If the file is not validated, the attacker can, for example, upload a malicious executable script such as a PHP file (e.g., `malicious_file.php`).
When this file is requested by a browser from the web server (e.g., by opening `www.example.org/uploads/malicious_file.php`), the web server may execute this script.
The attacker can thus **inject and execute arbitrary code** that, for example, **reads arbitrary files on the server or connects to the database**.

Another possible variant of the attack is that the attacker can use the server to upload arbitrary files and then link to them, effectively using the server as storage for large files or phishing pages.

If a **path traversal attack** is possible in addition to the unrestricted file upload, the attacker can place the uploaded file at a different path than the intended one.
This could allow the attacker to overwrite the Python code or other files on the server.
