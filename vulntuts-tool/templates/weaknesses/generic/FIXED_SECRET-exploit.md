Time-based one-time passwords (TOTP) are used as second authentication factor in a number of two-factor authentication (2FA) systems. For this purpose, an OTP code is calculated on the basis of an OTP secret. The user has to enter the correct OTP code to be able to log in.

If the OTP secret is hard-coded into the software, an attacker may be able to find it out. The attacker is then able to calculate the correct OTP code based on the hard-coded OTP secret. As a result, he only needs to figure out the first factor (usually the password) to log in. **Using a hard-coded OTP secret** rather than a random one for each user completely **eliminates the security benefit that a correctly implemented two-factor authentication would have.**

There are different ways how an attacker can obtain the OTP secret and calculate the OTP code:

- If the OTP secret is hard-coded into the application, it is the same for every user. As a result, the OTP code that must be entered to log in is also the same for every user. An attacker who has an account has the same OTP code as all other user.
- If the source code is publicly available (e.g., on GitHub or as software download), an attacker can find the OTP secret in the source code and calculate the OTP code.
- If there are several installations of the software (i.e., the software is used by several people/organizations), the OTP secret is the same for each installation. A user who knows the OTP secret of one installation also knows the OTP secret of the other installation (of another organization) and can calculate the OTP code.
