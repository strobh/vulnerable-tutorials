In a path traversal attack, an attacker aims to access files and directories that are stored outside the web root folder or outside the intended path.
To do this, an attacker manipulates an input value that is sent to the server and used by it to generate a path, which the server then accesses.

A common example is when the server provides the ability to download files from a directory, e.g., by opening `www.example.org/download?file=report.pdf` in the browser:

<pre class="language-java line-numbers"><code>
import java.io.*;
import javax.servlet.*;
import javax.servlet.http.*;
import javax.servlet.annotation.*;

@WebServlet("/download")
public class DownloadServlet extends HttpServlet {
    private final int ARBITARY_SIZE = 1048;

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) 
        throws ServletException, IOException
    {
        String fileName = req.getParameter("file");
    
        resp.setContentType("text/plain");
        resp.setHeader("Content-disposition", "attachment; filename=" + fileName);

        try(InputStream in = req.getServletContext().getRealPath("/").getResourceAsStream(fileName);
            OutputStream out = resp.getOutputStream()) {

            byte[] buffer = new byte[ARBITARY_SIZE];
        
            int numBytesRead;
            while ((numBytesRead = in.read(buffer)) > 0) {
                out.write(buffer, 0, numBytesRead);
            }
        }
    }
}
</code></pre>

If the attacker uses the value `../report.pdf` for the `file` parameter (encoded as `%2e%2e%2freport.pdf` in the URL), the server will try to access a file one level higher than originally intended.
The attacker is thus able to **download arbitrary files from the server**, such as Java files or configuration files with database passwords.

Another example where a path traversal attack can occur is when the user uploads a file to a server.
If the application uses the file name specified by the user/browser to name the file on the server, an attacker can manipulate the path here as well.
An attacker is then be able to **upload the file to another location** and possibly overwrite other files such as configuration files or program code.
