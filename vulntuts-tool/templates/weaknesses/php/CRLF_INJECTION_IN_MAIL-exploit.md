Let's assume a website has a contact form where a user can send an email to the website owner:

<pre class="language-php line-numbers"><code>
$headers = "From: " . $_POST['email'] . "\r\n";
mail("contact@example.org", $_POST['subject'], $_POST['text'], $headers);
</code></pre>

The email headers supplied to the `mail` function can contain data such as the sender or the receiver of the email.
In the snippet above the email header only consists of the `From` header that uses the email supplied by the user in the contact form (`$_POST['email']`).

If the user enters `tom@example.org` as `email`, the resulting email header (`$headers`) is:

<pre class="language-http line-numbers"><code>
From: tom@example.org\r\n
</code></pre>

Let's assume an attacker enters the following string as `email`:

<pre class="language-http line-numbers"><code>
tom@example.org\r\n
Cc: somebody@example.org
</code></pre>

Then the resulting email headers (`$headers`) are:

<pre class="language-http line-numbers"><code>
From: tom@example.org\r\n
Cc: somebody@example.org\r\n
</code></pre>

Email headers are separated by special control characters that mark a line break (`\r\n`, called Carriage Return and Line Feed, or CRLF).
If the software does not validate the user input, an attacker can use these characters to add new headers to the email.
In this case, the attacker inserted a line break and added a `Cc` header such that the email is also sent to `somebody@example.org`.

An attacker could manipulate the email headers to **send large numbers of messages anonymously**, e.g., to send spam emails others.
