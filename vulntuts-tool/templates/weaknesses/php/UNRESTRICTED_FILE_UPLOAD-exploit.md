If a server software offers the functionality to upload files, this may provide attackers the ability to also upload malicious files to the server if it does not validate the files.

A common variant is that the software saves the file to a folder within the web document root (e.g., a folder named `uploads`:

<pre class="language-php line-numbers"><code>
$target_dir = "uploads/";
$target_file = $target_dir . basename($_FILES["file"]["name"]);

if (move_uploaded_file($_FILES["file"]["tmp_name"], $target_file)) {
    echo "The file ". htmlspecialchars(basename($_FILES["file"]["name"])). " has been uploaded.";
} else {
    echo "There was an error uploading your file.";
}
</code></pre>

If the file is not validated, the attacker can, for example, upload a malicious executable script such as a PHP file (e.g., `malicious_file.php`).
When this file is requested by a browser from the web server (e.g., by opening `www.example.org/uploads/malicious_file.php`), the web server executes this script.
The attacker can thus **inject and execute arbitrary code** that, for example, **reads arbitrary files on the server or connects to the database**.

Another possible variant of the attack is that the attacker can use the server to upload arbitrary files and then link to them, effectively using the server as storage for large files or phishing pages.
