Cross-Site Scripting (XSS) occurs when a web application accepts data from untrusted sources (e.g., user input from a form) and then sends this data to a browser without checking the content. More precisely, the untrusted data is printed as part of the page content when the page is accessed by a user.
This allows an attacker to inject JavaScript code into a page that is indirectly sent to the browser of all users when they visit the page. The malicious code is then executed in the client's browser.

**Stored Cross-Site Scripting** is a subcategory of XSS where the user input is **stored by the server** (e.g., in a database) and sent to each user when the web page is accessed.

Example: A web shop where users can write reviews for a product. The following code loads the reviews from a database and prints them

<pre class="language-php line-numbers" data-line="9-10"><code>
$product_id = $_GET["product_id"];

// load reviews for the product
$stmt = $conn->prepare("SELECT * FROM reviews WHERE product_id = :product_id");
$stmt->bindParam(':product_id', $product_id);
$stmt->execute();
while ($row = $stmt->fetch()) {
    echo "&lt;p>";
    echo $row['author'] . " has written:&lt;br />";
    echo $row['review'];
    echo "&lt;/p>";
}
</code></pre>

Let's assume a user (`reviewer1`) enters the following text as review:

<pre class="language-html line-numbers"><code>
Awesome product!
&lt;script>
alert("Malicious code");
&lt;/script>
</code></pre>

The resulting HTML of the web page would look like this:

<pre class="language-html line-numbers"><code>
&lt;h1>Reviews for this product&lt;/h1>

&lt;p>
reviewer1 has written:&lt;br />
Awesome product!
&lt;script>
alert("Malicious code");
&lt;/script>
&lt;/p>
</code></pre>

The script tag is printed as it was entered by the user and, therefore, also recognized as HTML and executed by the browser.

The injected malicious code may, for example,

- access the browser's session cookies for the website, allowing the attacker to **log in as the user**,
- record user input (keylogger), allowing the attacker to **find out passwords, credit card numbers, or addresses**,
- **change the web page as desired** (e.g., redirecting payments in a shop to the attacker),
- or use the computing power of the browser to **mine bitcoins** or other cryptocurrencies.
