Cross-Site Scripting (XSS) in an HTML email occurs when a web application accepts data from untrusted sources (e.g., user input from a form) and then sends this data in an email without checking the content.
This allows an attacker to inject JavaScript code into the HTML email. The malicious code is then executed in the recipient's email client when the email is viewed.

Example: A contact form that sends an email to the website owner

<pre class="language-php line-numbers" data-line="9,13"><code>
$subject = "Contact form on example.org";
$headers = "MIME-Version: 1.0\r\n"
    . "Content-type: text/html; charset=utf-8\r\n"
    . "From: contact@example.org\r\n";

$email_body = "
    &lt;div>
        &lt;label>Name:&lt;/label>
        " . $_POST['name'] . "
    &lt;/div>
    &lt;div>
        &lt;label>Text:&lt;/label>
        " . $_POST['text'] . "
    &lt;/div>";

mail("contact@example.org", $subject, $email_body, $headers);
</code></pre>

Let's assume a visitor (`Tom`) enters the following text:

<pre class="language-html line-numbers"><code>
Hello, I have a question regarding your website...
&lt;script>
alert("Malicious code");
&lt;/script>
</code></pre>

The resulting HTML of the email would look like this:

<pre class="language-html line-numbers"><code>
&lt;div>
    &lt;label>Name:&lt;/label>
    Tom
&lt;/div>
&lt;div>
    &lt;label>Text:&lt;/label>
    Hello, I have a question regarding your website...
    &lt;script>
    alert("Malicious code");
    &lt;/script>
&lt;/div>
</code></pre>

The script tag is printed as it was entered by the user and, therefore, also recognized as HTML and executed by the email client.

The injected malicious code may, for example,

- **change the email content as desired** (e.g., manipulating the content or links),
- or use the computing power of the email client to **mine bitcoins** or other cryptocurrencies.
